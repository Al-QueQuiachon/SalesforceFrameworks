<template>
    <div class="slds-card">
        <div class="slds-card__header slds-grid">
            <h2 class="slds-text-heading_medium slds-card__header-title">PDF Processor</h2>
        </div>
        <div class="slds-card__body slds-card__body_inner">
            <!-- File Upload Section -->
            <div class="slds-m-bottom_medium">
                <lightning-file-upload
                    label="Upload PDF"
                    name="pdfUploader"
                    accept={acceptedFormats}
                    record-id={recordId}
                    onuploadfinished={handleUploadFinished}
                    multiple="false">
                </lightning-file-upload>
            </div>
            
            <!-- Always include the containers but hide them when not needed -->
            <!-- PDF Preview Section -->
            <div class="slds-m-bottom_medium">
                <div class="slds-text-heading_small slds-m-bottom_x-small" style={previewStyle}>Original PDF</div>
                <div class="pdf-container" style={previewStyle}></div>
            </div>
            
            <!-- Signature Section -->
            <div class="slds-m-bottom_medium" style={signatureStyle}>
                <div class="slds-text-heading_small slds-m-bottom_x-small">Add Signature</div>
                <div class="signature-container">
                    <canvas class="signature-pad"></canvas>
                </div>
                <div class="slds-grid slds-gutters slds-m-top_small">
                    <div class="slds-col">
                        <lightning-button 
                            label="Clear Signature" 
                            onclick={handleClearSignature}
                            variant="neutral">
                        </lightning-button>
                    </div>
                    <div class="slds-col">
                        <lightning-button 
                            label="Apply Signature" 
                            onclick={handleApplySignature}
                            variant="brand">
                        </lightning-button>
                    </div>
                </div>
            </div>
            
            <!-- Actions Section -->
            <div class="slds-grid slds-gutters slds-m-top_medium">
                <div class="slds-col">
                    <lightning-button 
                        style={previewStyle}
                        label="Add Signature" 
                        onclick={handleAddSignature}
                        variant="brand">
                    </lightning-button>
                </div>
                <div class="slds-col">
                    <lightning-button 
                        style={downloadStyle}
                        label="Download PDF" 
                        onclick={handleDownloadPdf}
                        variant="success">
                    </lightning-button>
                </div>
            </div>
        </div>
        
        <!-- Spinner -->
        <template if:true={isLoading}>
            <div class="slds-spinner_container">
                <div class="slds-spinner slds-spinner_medium" role="status">
                    <span class="slds-assistive-text">Loading</span>
                    <div class="slds-spinner__dot-a"></div>
                    <div class="slds-spinner__dot-b"></div>
                </div>
            </div>
        </template>
    </div>
</template>